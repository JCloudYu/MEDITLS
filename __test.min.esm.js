import fs from"fs";import{createHash,createECDH,createSign}from"crypto";import{Beson,Serializer}from"beson/beson.esm.js";import{UniqueId}from"jsboost/unique-id.esm.js";import{Buffer}from"buffer";const{UInt8:UInt8,UInt16:UInt16}=Beson;var current_date=(new Date).valueOf().toString(),random=Math.random().toString(),sha1=createHash("sha1").update(current_date+random).digest("hex");let ecdh=createECDH("secp384r1");ecdh.generateKeys();const privateKey=`-----BEGIN PRIVATE KEY-----\n${ecdh.getPrivateKey("base64").match(/.{1,64}/g).join("\n")}\n-----END PRIVATE KEY-----`,publicKey=`-----BEGIN PUBLIC KEY-----\n${ecdh.getPublicKey("base64").match(/.{1,64}/g).join("\n")}\n-----END PUBLIC KEY-----`;var pem=fs.readFileSync("cheny_asus.pub"),key=pem.toString("ascii"),sign=createSign("RSA-SHA256");sign.write("This is the test document"),sign.end();var signature=sign.sign(key,"hex");const data=["3",(new UniqueId).toString("hex"),Math.ceil((new Date).getTime()/1e3),Math.ceil((new Date).getTime()/1e3),(new UniqueId).toString("hex"),"US","Texas","Houston","SSL Corp","SSL.com EV SSL Intermediate CA RSA R3","US","Texas","Houston","SSL Corp",(new UniqueId).toString("hex"),"SSL.com EV SSL Intermediate CA RSA R3","999999","Private Organization","3100 Richmond Ave","Nevada","US","EC Encryption",256,sha1,publicKey,"1.2.840.113549.1.1.11",signature];let obj={};function roughSizeOfObject(e){var t=[],n=function(e){var o=0;if("boolean"==typeof e)o=1;else if("string"==typeof e)o=2*e.length;else if("number"==typeof e&&e<65536)o=2;else if("number"==typeof e&&e>65536)o=4;else if("object"==typeof e&&-1===t.indexOf(e)){t[t.length]=e;for(let t in e)o+=8,o+=n(e[t])}return o};return n(e)}data.forEach((e,t)=>{obj[t]=e}),console.log(obj),console.log(roughSizeOfObject(obj));